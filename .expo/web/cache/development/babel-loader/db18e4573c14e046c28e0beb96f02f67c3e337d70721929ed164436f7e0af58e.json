{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useContext, useRef, useEffect } from 'react';\nimport PanResponder from \"react-native-web/dist/exports/PanResponder\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport HomeAdmin from \"./homeScreenAdmin\";\nimport HomeUser from \"./homeScreenUser\";\nimport { ThemeContext } from \"../../components/theme/themeManager\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport styles from \"./homeScreenNo.styles\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar HomeScreenNo = function HomeScreenNo(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    menuVisible = _useState2[0],\n    setMenuVisible = _useState2[1];\n  var _useContext = useContext(ThemeContext),\n    theme = _useContext.theme;\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userData = _useState4[0],\n    setUserData = _useState4[1];\n  var _useState5 = useState(true),\n    _useState6 = _slicedToArray(_useState5, 2),\n    loading = _useState6[0],\n    setLoading = _useState6[1];\n  var menuPosition = useRef(new Animated.ValueXY()).current;\n  var panResponder = useRef(PanResponder.create({\n    onStartShouldSetPanResponder: function onStartShouldSetPanResponder() {\n      return true;\n    },\n    onPanResponderMove: function onPanResponderMove(event, gesture) {\n      menuPosition.setValue({\n        x: gesture.dx,\n        y: gesture.dy\n      });\n    },\n    onPanResponderRelease: function onPanResponderRelease(event, gesture) {\n      if (gesture.dx > 50) {\n        setMenuVisible(true);\n      } else {\n        setMenuVisible(false);\n      }\n      Animated.spring(menuPosition, {\n        toValue: {\n          x: 0,\n          y: 0\n        },\n        useNativeDriver: false\n      }).start();\n    }\n  })).current;\n  useEffect(function () {\n    var fetchProfileData = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        var userToken = yield AsyncStorage.getItem('userToken');\n        var userId = yield AsyncStorage.getItem('userId');\n        var endpoint = `http://${global.ipDireccion}:3000/api/admins/${userId}`;\n        try {\n          var response = yield fetch(endpoint, {\n            method: 'GET',\n            headers: {\n              'Authorization': `Bearer ${userToken}`\n            }\n          });\n          if (response.ok) {\n            var json = yield response.json();\n            setUserData(json);\n          } else {\n            var errorMessage = yield response.text();\n            throw new Error(errorMessage || \"Error al obtener datos del perfil.\");\n          }\n          if (userData) {\n            navigation.navigate('Login');\n          }\n        } catch (error) {\n          Alert.alert(\"Error\", error.message || \"Ocurrió un error inesperado.\");\n        } finally {\n          setLoading(false);\n        }\n      });\n      return function fetchProfileData() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    fetchProfileData();\n  }, [navigation]);\n  return _jsx(_Fragment, {\n    children: userData && userData.role === 'admin' ? _jsx(_Fragment, {\n      children: _jsx(HomeAdmin, {\n        navigation: navigation\n      })\n    }) : _jsx(_Fragment, {\n      children: _jsx(HomeUser, {\n        navigation: navigation\n      })\n    })\n  });\n};\nexport default HomeScreenNo;","map":{"version":3,"names":["React","useState","useContext","useRef","useEffect","PanResponder","Animated","Alert","HomeAdmin","HomeUser","ThemeContext","AsyncStorage","styles","jsx","_jsx","Fragment","_Fragment","HomeScreenNo","_ref","navigation","_useState","_useState2","_slicedToArray","menuVisible","setMenuVisible","_useContext","theme","_useState3","_useState4","userData","setUserData","_useState5","_useState6","loading","setLoading","menuPosition","ValueXY","current","panResponder","create","onStartShouldSetPanResponder","onPanResponderMove","event","gesture","setValue","x","dx","y","dy","onPanResponderRelease","spring","toValue","useNativeDriver","start","fetchProfileData","_ref2","_asyncToGenerator","userToken","getItem","userId","endpoint","global","ipDireccion","response","fetch","method","headers","ok","json","errorMessage","text","Error","navigate","error","alert","message","apply","arguments","children","role"],"sources":["C:/Users/lofli/Downloads/integradora-misto/views/homeScreen/homeScreen.js"],"sourcesContent":["\n\nimport React, { useState, useContext, useRef,useEffect } from 'react';\nimport { PanResponder,Animated,Alert } from 'react-native';\nimport HomeAdmin from './homeScreenAdmin';\nimport HomeUser from './homeScreenUser';\nimport { ThemeContext } from \"../../components/theme/themeManager\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport styles from './homeScreenNo.styles';\n\nconst HomeScreenNo = ({ navigation }) => {\n  const [menuVisible, setMenuVisible] = useState(false);\n  const { theme } = useContext(ThemeContext);\n  const [userData, setUserData] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  const menuPosition = useRef(new Animated.ValueXY()).current;\n\n  const panResponder = useRef(\n    PanResponder.create({\n      onStartShouldSetPanResponder: () => true,\n      onPanResponderMove: (event, gesture) => {\n        menuPosition.setValue({ x: gesture.dx, y: gesture.dy });\n      },\n      \n      onPanResponderRelease: (event, gesture) => {\n        if (gesture.dx > 50) {\n          setMenuVisible(true);\n        } else {\n          setMenuVisible(false);\n        }\n        Animated.spring(menuPosition, {\n          toValue: { x: 0, y: 0 },\n          useNativeDriver: false,\n        }).start();\n      },\n    })\n  ).current;\n\n  useEffect(() => {\n    const fetchProfileData = async () => {\n      const userToken = await AsyncStorage.getItem('userToken');\n      const userId = await AsyncStorage.getItem('userId');\n\n      const endpoint = `http://${global.ipDireccion}:3000/api/admins/${userId}`;\n\n      try {\n        const response = await fetch(endpoint, {\n          method: 'GET',\n          headers: {\n            'Authorization': `Bearer ${userToken}`,\n          },\n        });\n\n        if (response.ok) {\n          const json = await response.json();\n          setUserData(json);\n        } else {\n          const errorMessage = await response.text();\n          throw new Error(errorMessage || \"Error al obtener datos del perfil.\");\n        }\n\n        if (userData) {\n          navigation.navigate('Login');\n        }\n      } catch (error) {\n        Alert.alert(\"Error\", error.message || \"Ocurrió un error inesperado.\");\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchProfileData();\n  }, [navigation]);\n\n  return (\n    <>\n    {userData && userData.role === 'admin' ? (\n      <>\n        <HomeAdmin navigation={navigation}/>\n      </>\n    ) : (\n      <>\n        <HomeUser navigation={navigation}/>\n      </>\n    )}\n  </>\n    \n  );\n\n};\n\nexport default HomeScreenNo;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}